<html><head><title>Dancer::Request</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.22,
  using Pod::Simple::PullParser v3.22,
  under Perl v5.014001 at Sun Jun 24 19:07:14 2012 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#PUBLIC_INTERFACE'>PUBLIC INTERFACE</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#new()'>new()</a>
    <li class='indexItem indexItem2'><a href='#init()'>init()</a>
    <li class='indexItem indexItem2'><a href='#new_for_request(%24method%2C_%24path%2C_%24params%2C_%24body%2C_%24headers)'>new_for_request($method, $path, $params, $body, $headers)</a>
    <li class='indexItem indexItem2'><a href='#forward(%24request%2C_%24new_location)'>forward($request, $new_location)</a>
    <li class='indexItem indexItem2'><a href='#to_string()'>to_string()</a>
    <li class='indexItem indexItem2'><a href='#method()'>method()</a>
    <li class='indexItem indexItem2'><a href='#address()'>address()</a>
    <li class='indexItem indexItem2'><a href='#remote_host()'>remote_host()</a>
    <li class='indexItem indexItem2'><a href='#protocol()'>protocol()</a>
    <li class='indexItem indexItem2'><a href='#port()'>port()</a>
    <li class='indexItem indexItem2'><a href='#uri()'>uri()</a>
    <li class='indexItem indexItem2'><a href='#request_uri()'>request_uri()</a>
    <li class='indexItem indexItem2'><a href='#user()'>user()</a>
    <li class='indexItem indexItem2'><a href='#script_name()'>script_name()</a>
    <li class='indexItem indexItem2'><a href='#scheme()'>scheme()</a>
    <li class='indexItem indexItem2'><a href='#secure()'>secure()</a>
    <li class='indexItem indexItem2'><a href='#is_get()'>is_get()</a>
    <li class='indexItem indexItem2'><a href='#is_head()'>is_head()</a>
    <li class='indexItem indexItem2'><a href='#is_patch()'>is_patch()</a>
    <li class='indexItem indexItem2'><a href='#is_post()'>is_post()</a>
    <li class='indexItem indexItem2'><a href='#is_put()'>is_put()</a>
    <li class='indexItem indexItem2'><a href='#is_delete()'>is_delete()</a>
    <li class='indexItem indexItem2'><a href='#path()'>path()</a>
    <li class='indexItem indexItem2'><a href='#base()'>base()</a>
    <li class='indexItem indexItem2'><a href='#uri_base()'>uri_base()</a>
    <li class='indexItem indexItem2'><a href='#uri_for(path%2C_params)'>uri_for(path, params)</a>
    <li class='indexItem indexItem2'><a href='#params(%24source)'>params($source)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Fetching_only_params_from_a_given_source'>Fetching only params from a given source</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#Vars'>Vars</a>
    <li class='indexItem indexItem2'><a href='#request_method'>request_method</a>
    <li class='indexItem indexItem2'><a href='#input_handle'>input_handle</a>
    <li class='indexItem indexItem2'><a href='#content_type()'>content_type()</a>
    <li class='indexItem indexItem2'><a href='#content_length()'>content_length()</a>
    <li class='indexItem indexItem2'><a href='#header(%24name)'>header($name)</a>
    <li class='indexItem indexItem2'><a href='#body()'>body()</a>
    <li class='indexItem indexItem2'><a href='#is_ajax()'>is_ajax()</a>
    <li class='indexItem indexItem2'><a href='#env()'>env()</a>
    <li class='indexItem indexItem2'><a href='#uploads()'>uploads()</a>
    <li class='indexItem indexItem2'><a href='#upload(%24name)'>upload($name)</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#HTTP_environment_variables'>HTTP environment variables</a>
  <li class='indexItem indexItem1'><a href='#AUTHORS'>AUTHORS</a>
  <li class='indexItem indexItem1'><a href='#LICENCE'>LICENCE</a>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Dancer::Request - interface for accessing incoming requests</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This class implements a common interface for accessing incoming requests in a Dancer application.</p>

<p>In a route handler,
the current request object can be accessed by the <code>request</code> method,
like in the following example:</p>

<pre>    get &#39;/foo&#39; =&#62; sub {
        request-&#62;params; # request, params parsed as a hash ref
        request-&#62;body; # returns the request body, unparsed
        request-&#62;path; # the path requested by the client
        # ...
    };</pre>

<p>A route handler should not read the environment by itself, but should instead use the current request object.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PUBLIC_INTERFACE"
>PUBLIC INTERFACE</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="new()"
>new()</a></h2>

<p>The constructor of the class, used internally by Dancer&#39;s core to create request objects.</p>

<p>It uses the environment hash table given to build the request object:</p>

<pre>    Dancer::Request-&#62;new(env =&#62; \%ENV);</pre>

<p>It also accepts the <code>is_forward</code> boolean flag, if the new request object is the result of a forward.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="init()"
>init()</a></h2>

<p>Used internally to define some default values and parse parameters.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="new_for_request($method,_$path,_$params,_$body,_$headers)"
>new_for_request($method, $path, $params, $body, $headers)</a></h2>

<p>An alternate constructor convienient for test scripts which creates a request object with the arguments given.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="forward($request,_$new_location)"
>forward($request, $new_location)</a></h2>

<p>Create a new request which is a clone of the current one, apart from the path location, which points instead to the new location. This is used internally to chain requests using the forward keyword.</p>

<p>Note that the new location should be a hash reference. Only one key is required, the <code>to_url</code>, that should point to the URL that forward will use. Optional values are the key <code>params</code> to a hash of parameters to be added to the current request parameters, and the key <code>options</code> that points to a hash of options about the redirect (for instance, <code>method</code> pointing to a new request method).</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="to_string()"
>to_string()</a></h2>

<p>Return a string representing the request object (eg: <code>&#34;GET /some/path&#34;</code>)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="method()"
>method()</a></h2>

<p>Return the HTTP method used by the client to access the application.</p>

<p>While this method returns the method string as provided by the environment, it&#39;s better to use one of the following boolean accessors if you want to inspect the requested method.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="address()"
>address()</a></h2>

<p>Return the IP address of the client.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="remote_host()"
>remote_host()</a></h2>

<p>Return the remote host of the client. This only works with web servers configured to do a reverse DNS lookup on the client&#39;s IP address.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="protocol()"
>protocol()</a></h2>

<p>Return the protocol (HTTP/1.0 or HTTP/1.1) used for the request.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="port()"
>port()</a></h2>

<p>Return the port of the server.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="uri()"
>uri()</a></h2>

<p>An alias to request_uri()</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="request_uri()"
>request_uri()</a></h2>

<p>Return the raw, undecoded request URI path.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="user()"
>user()</a></h2>

<p>Return remote user if defined.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="script_name()"
>script_name()</a></h2>

<p>Return script_name from the environment.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="scheme()"
>scheme()</a></h2>

<p>Return the scheme of the request</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="secure()"
>secure()</a></h2>

<p>Return true of false, indicating whether the connection is secure</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="is_get()"
>is_get()</a></h2>

<p>Return true if the method requested by the client is &#39;GET&#39;</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="is_head()"
>is_head()</a></h2>

<p>Return true if the method requested by the client is &#39;HEAD&#39;</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="is_patch()"
>is_patch()</a></h2>

<p>Return true if the method requested by the client is &#39;PATCH&#39;</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="is_post()"
>is_post()</a></h2>

<p>Return true if the method requested by the client is &#39;POST&#39;</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="is_put()"
>is_put()</a></h2>

<p>Return true if the method requested by the client is &#39;PUT&#39;</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="is_delete()"
>is_delete()</a></h2>

<p>Return true if the method requested by the client is &#39;DELETE&#39;</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="path()"
>path()</a></h2>

<p>Return the path requested by the client.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="base()"
>base()</a></h2>

<p>Returns an absolute URI for the base of the application. Returns a <a href="../../URI.html" class="podlinkpod"
>URI</a> object (which stringifies to the URL, as you&#39;d expect).</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="uri_base()"
>uri_base()</a></h2>

<p>Same thing as <code>base</code> above, except it removes the last trailing slash in the path if it is the only path.</p>

<p>This means that if your base is <i>http://myserver/</i>, <code>uri_base</code> will return <i>http://myserver</i> (notice no trailing slash). This is considered very useful when using templates to do the following thing:</p>

<pre>    &#60;link rel=&#34;stylesheet&#34; href=&#34;&#60;% request.uri_base %&#62;/css/style.css&#34; /&#62;</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="uri_for(path,_params)"
>uri_for(path, params)</a></h2>

<p>Constructs a URI from the base and the passed path. If params (hashref) is supplied, these are added to the query string of the uri. If the base is <code>http://localhost:5000/foo</code>, <code>request-&#62;uri_for(&#39;/bar&#39;, { baz =&#62; &#39;baz&#39; })</code> would return <code>http://localhost:5000/foo/bar?baz=baz</code>. Returns a <a href="../../URI.html" class="podlinkpod"
>URI</a> object (which stringifies to the URL, as you&#39;d expect).</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="params($source)"
>params($source)</a></h2>

<p>Called in scalar context, returns a hashref of params, either from the specified source (see below for more info on that) or merging all sources.</p>

<p>So, you can use, for instance:</p>

<pre>    my $foo = params-&#62;{foo}</pre>

<p>If called in list context, returns a list of key =&#62; value pairs, so you could use:</p>

<pre>    my %allparams = params;</pre>

<p>If the incoming form data contains multiple values for the same key, they will be returned as an arrayref.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Fetching_only_params_from_a_given_source"
>Fetching only params from a given source</a></h3>

<p>If a required source isn&#39;t specified, a mixed hashref (or list of key value pairs, in list context) will be returned; this will contain params from all sources (route, query, body).</p>

<p>In practical terms, this means that if the param <code>foo</code> is passed both on the querystring and in a POST body, you can only access one of them.</p>

<p>If you want to see only params from a given source, you can say so by passing the <code>$source</code> param to <code>params()</code>:</p>

<pre>    my %querystring_params = params(&#39;query&#39;);
    my %route_params       = params(&#39;route&#39;);
    my %post_params        = params(&#39;body&#39;);</pre>

<p>If source equals <code>route</code>, then only params parsed from the route pattern are returned.</p>

<p>If source equals <code>query</code>, then only params parsed from the query string are returned.</p>

<p>If source equals <code>body</code>, then only params sent in the request body will be returned.</p>

<p>If another value is given for <code>$source</code>, then an exception is triggered.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Vars"
>Vars</a></h2>

<p>Alias to the <code>params</code> accessor, for backward-compatibility with <code>CGI</code> interface.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="request_method"
>request_method</a></h2>

<p>Alias to the <code>method</code> accessor, for backward-compatibility with <code>CGI</code> interface.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="input_handle"
>input_handle</a></h2>

<p>Alias to the PSGI input handle (<code>&#60;request-&#62;env-&#62;{psgi.input}&#62;</code>)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="content_type()"
>content_type()</a></h2>

<p>Return the content type of the request.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="content_length()"
>content_length()</a></h2>

<p>Return the content length of the request.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="header($name)"
>header($name)</a></h2>

<p>Return the value of the given header, if present. If the header has multiple values, returns an the list of values if called in list context, the first one in scalar.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="body()"
>body()</a></h2>

<p>Return the raw body of the request, unparsed.</p>

<p>If you need to access the body of the request, you have to use this accessor and should not try to read <code>psgi.input</code> by hand. <code>Dancer::Request</code> already did it for you and kept the raw body untouched in there.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="is_ajax()"
>is_ajax()</a></h2>

<p>Return true if the value of the header <code>X-Requested-With</code> is XMLHttpRequest.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="env()"
>env()</a></h2>

<p>Return the current environment (<code>%ENV</code>), as a hashref.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="uploads()"
>uploads()</a></h2>

<p>Returns a reference to a hash containing uploads. Values can be either a <a href="../../Dancer/Request/Upload.html" class="podlinkpod"
>Dancer::Request::Upload</a> object, or an arrayref of <a href="../../Dancer/Request/Upload.html" class="podlinkpod"
>Dancer::Request::Upload</a> objects.</p>

<p>You should probably use the <code>upload($name)</code> accessor instead of manually accessing the <code>uploads</code> hash table.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="upload($name)"
>upload($name)</a></h2>

<p>Context-aware accessor for uploads. It&#39;s a wrapper around an access to the hash table provided by <code>uploads()</code>. It looks at the calling context and returns a corresponding value.</p>

<p>If you have many file uploads under the same name, and call <code>upload(&#39;name&#39;)</code> in an array context, the accesor will unroll the ARRAY ref for you:</p>

<pre>    my @uploads = request-&#62;upload(&#39;many_uploads&#39;); # OK</pre>

<p>Whereas with a manual access to the hash table, you&#39;ll end up with one element in @uploads, being the ARRAY ref:</p>

<pre>    my @uploads = request-&#62;uploads-&#62;{&#39;many_uploads&#39;}; # $uploads[0]: ARRAY(0xXXXXX)</pre>

<p>That is why this accessor should be used instead of a manual access to <code>uploads</code>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="HTTP_environment_variables"
>HTTP environment variables</a></h1>

<p>All HTTP environment variables that are in %ENV will be provided in the Dancer::Request object through specific accessors, here are those supported:</p>

<dl>
<dt><a name="accept"
><code>accept</code></a></dt>

<dd>
<dt><a name="accept_charset"
><code>accept_charset</code></a></dt>

<dd>
<dt><a name="accept_encoding"
><code>accept_encoding</code></a></dt>

<dd>
<dt><a name="accept_language"
><code>accept_language</code></a></dt>

<dd>
<dt><a name="accept_type"
><code>accept_type</code></a></dt>

<dd>
<dt><a name="agent_(alias_for_user_agent)"
><code>agent</code> (alias for <code>user_agent</code>)</a></dt>

<dd>
<dt><a name="connection"
><code>connection</code></a></dt>

<dd>
<dt><a name="forwarded_for_address"
><code>forwarded_for_address</code></a></dt>

<dd>
<dt><a name="forwarded_protocol"
><code>forwarded_protocol</code></a></dt>

<dd>
<dt><a name="forwarded_host"
><code>forwarded_host</code></a></dt>

<dd>
<dt><a name="host"
><code>host</code></a></dt>

<dd>
<dt><a name="keep_alive"
><code>keep_alive</code></a></dt>

<dd>
<dt><a name="path_info"
><code>path_info</code></a></dt>

<dd>
<dt><a name="referer"
><code>referer</code></a></dt>

<dd>
<dt><a name="remote_address"
><code>remote_address</code></a></dt>

<dd>
<dt><a name="user_agent"
><code>user_agent</code></a></dt>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHORS"
>AUTHORS</a></h1>

<p>This module has been written by Alexis Sukrieh and was mostly inspired by <a href="../../Plack/Request.html" class="podlinkpod"
>Plack::Request</a>, written by Tatsuiko Miyagawa.</p>

<p>Tatsuiko Miyagawa also gave a hand for the PSGI interface.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="LICENCE"
>LICENCE</a></h1>

<p>This module is released under the same terms as Perl itself.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../../Dancer.html" class="podlinkpod"
>Dancer</a></p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
